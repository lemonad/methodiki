{% extends "base-with-sidebar.html" %}
{% load i18n thumbnail %}
{% block javascript %}
  <script type="text/javascript">
    $(document).ready(function() {
      $("a.avatar-preview").fancybox({"hideOnContentClick": true,
                                     "margin": 14});
    });
  </script>
{% endblock %}

{% block sidebar %}
  {% include "sidebar/preferences-sidebar-info.html" %}
{% endblock %}

{% block navigation %}
  <ul>
    <li class="rounded-9"><a href="#">{% trans "Account" %}</a></li>
    <li class="rounded-9"><a href="#">{% trans "Password" %}</a></li>
    <li class="rounded-9"><a href="#">{% trans "Notices" %}</a></li>
    <li class="rounded-9 active"><a href="#">{% trans "Profile" %}</a></li>
  </ul>
{% endblock %}

{% block main %}
  <div class="prepend-2 span-12 append-2 last">
    <div id="preferences-profile-form"
         class="rounded-9">
      <h2>
        {% trans "Edit your profile information" %}
      </h2>

      <form action="#" id="profile-form" enctype="multipart/form-data"
            method="post">
        {% csrf_token %}

        <div class="span-12 last">
          {% for error in form.non_field_errors %}
          <p class="error">
            {{ error|escape }}
          </p>
          {% endfor %}
        </div>

        <fieldset>
          {% if form.avatar.errors %}
          <div class="span-12 last">
            {% for error in form.avatar.errors %}
            <p class="error">{{ error|escape }}</p>
            {% endfor %}
          </div>
          {% endif %}

          <div class="span-3{% if form.avatar.errors %} loud{% endif %}">
            {{ form.avatar.label_tag }}
          </div>
          <div class="span-9 last">
            {% if user.get_profile.avatar %}
            <a class="avatar-preview"
               href="{{ user.get_profile.avatar.url }}">
              <img src="{% thumbnail user.get_profile.avatar 100x100 %}"
                   style="padding:3px;background-color:white;border: 1px solid #999;" />
            </a>
            {% endif %}
            <div class="span-9 last">
              {{ form.avatar }}
            </div>
          </div>
        </fieldset>

        <fieldset class="prepend-top">
          {% if form.name.errors %}
          <div class="span-12 last">
            {% for error in form.name.errors %}
            <p class="error">{{ error|escape }}</p>
            {% endfor %}
          </div>
          {% endif %}

          <div class="span-3{% if form.name.errors %} loud{% endif %}">
            {{ form.name.label_tag }}
          </div>
          <div class="span-9 last">
            {{ form.name }}
          </div>
        </fieldset>

        <fieldset>
          <div class="span-12 last prepend-top" style="text-align:right;">
            <input type="submit" value="{% trans "Save" %}">
          </div>
        </fieldset>
      </form>

    </div>
  </div>
{% endblock %}
