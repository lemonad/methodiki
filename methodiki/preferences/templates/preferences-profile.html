{% extends "base-with-sidebar.html" %}
{% load i18n thumbnail %}
{% block css %}
  <link href="/media/javascript/jquery.fancybox-1.3.4/jquery.fancybox-1.3.4.css" rel="stylesheet" type="text/css" />
{% endblock %}
{% block javascript %}
  <script type="text/javascript" src="/media/javascript/jquery.fancybox-1.3.4/jquery.fancybox-1.3.4.pack.js"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      $("a.avatar-preview").fancybox({"hideOnContentClick": true,
                                     "margin": 14});
    });
  </script>
{% endblock %}
{% block sidebar %}
{% include "sidebar/preferences-sidebar-info.html" %}
{% endblock %}
{% block navigation %}
  <ul>
    <li class="rounded-9"><a href="#">{% trans "Account" %}</a></li>
    <li class="rounded-9"><a href="#">{% trans "Password" %}</a></li>
    <li class="rounded-9"><a href="#">{% trans "Notices" %}</a></li>
    <li class="rounded-9 active"><a href="#">{% trans "Profile" %}</a></li>
  </ul>
{% endblock %}
{% block main %}
  <h2>{% trans "Edit your profile information" %}</h2>

  <form action="" id="profile-form" enctype="multipart/form-data"
        method="post">
    {% csrf_token %}

    {% if form.non_field_errors %}
    <div class="span-10 append-8 last">
      {{ form.non_field_errors }}
    </div>
    {% endif %}

    <div class="span-10 append-8 last">
      {% if form.avatar.errors %}
      {% for error in form.avatar.errors %}
      <p class="error"><strong>{{ error|escape }}</strong></p>
      {% endfor %}
      {% endif %}
      <div class="span-4">
        {{ form.avatar.label_tag }}
      </div>
      <div class="span-6 last">
        {% if user.get_profile.avatar %}
        <a class="avatar-preview"
           href="{{ user.get_profile.avatar.url }}">
          <img src="{% thumbnail user.get_profile.avatar 50x50 %}"
               style="border: 1px solid #999;" />
        </a>
        {% endif %}
        {{ form.avatar }}
      </div>
    </div>

    <div class="span-10 append-8 last">
      {% if form.name.errors %}
      {% for error in form.name.errors %}
      <p class="error"><strong>{{ error|escape }}</strong></p>
      {% endfor %}
      {% endif %}
      <div class="span-4">
        {{ form.name.label_tag }}
      </div>
      <div class="span-6 last">
        {{ form.name }}
        <p>{{ form.name.help_text }}</p>
      </div>
    </div>

    <div class="span-10 append-8 last">
      <input type="submit" value="{% trans "Save" %}">
    </div>
  </form>
{% endblock %}
